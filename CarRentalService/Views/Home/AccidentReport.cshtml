@model CarRentalService.Models.AccidentReport

@{
    ViewData["Title"] = "Accident Report";
    var rental = ViewBag.Rental as CarRentalService.Models.Rental;
}

<div class="container mt-4 mb-5">

    <h2 class="mb-4 fw-bold">Accident Report</h2>

    @if (TempData["Msg"] != null)
    {
        <div class="alert alert-success">@TempData["Msg"]</div>
    }

    <div asp-validation-summary="All" class="text-danger mb-3"></div>


    @if (rental != null)
    {
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-light fw-bold">
                Rental Information
            </div>
            <div class="card-body">
                <p><strong>Vehicle:</strong> @rental.Vehicle?.Brand @rental.Vehicle?.Model</p>
                <p><strong>Pickup:</strong> @rental.Pickup.ToString("dd.MM.yyyy HH:mm")</p>
                <p><strong>Return:</strong> @rental.Return.ToString("dd.MM.yyyy HH:mm")</p>
            </div>
        </div>
    }

    <form method="post" asp-action="AccidentReport">


        @Html.AntiForgeryToken()

        <input type="hidden" name="RentalId" value="@rental?.Id" />

        <!-- ================= DRIVER INFO ================= -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-light fw-bold">
                1) Driver Information
            </div>
            <div class="card-body">

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Full name</label>
                        <input name="FullName" class="form-control" required />
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label">OIB</label>
                        <input name="Oib"
                               class="form-control"
                               pattern="\d{11}"
                               maxlength="11"
                               inputmode="numeric"
                               required
                               title="OIB must contain exactly 11 digits." />
                        <span asp-validation-for="Oib" class="text-danger"></span>


                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Driver license number</label>
                        <input name="DriverLicenseNumber"
                               class="form-control"
                               pattern="\d{8}"
                               maxlength="8"
                               inputmode="numeric"
                               required
                               title="Driver license number must contain exactly 8 digits." />
                        <span asp-validation-for="DriverLicenseNumber" class="text-danger"></span>

                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label">Phone</label>
                        <input name="Phone" class="form-control" />
                    </div>
                </div>

            </div>
        </div>

        <!-- ================= ACCIDENT DETAILS ================= -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-light fw-bold">
                2) Accident Details
            </div>
            <div class="card-body">

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Accident date & time</label>
                        <input type="datetime-local"
                               name="AccidentDate"
                               class="form-control"
                               required />
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label">Location</label>
                        <input name="Location"
                               class="form-control"
                               required />
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label">Weather conditions</label>
                        <select name="Weather" class="form-select">
                            <option>Clear</option>
                            <option>Rain</option>
                            <option>Snow</option>
                            <option>Fog</option>
                            <option>Storm</option>
                        </select>
                    </div>

                    <div class="col-md-6 mb-3">
                        <label class="form-label">Road conditions</label>
                        <select name="RoadCondition" class="form-select">
                            <option>Dry</option>
                            <option>Wet</option>
                            <option>Icy</option>
                            <option>Damaged</option>
                        </select>
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Speed at moment (km/h)</label>
                    <input type="number"
                           name="Speed"
                           class="form-control" />
                </div>

                <div class="form-check">
                    <input class="form-check-input"
                           type="checkbox"
                           name="PoliceNotified"
                           value="true"
                           id="policeCheck">
                    <label class="form-check-label" for="policeCheck">
                        Police were notified
                    </label>
                </div>

            </div>
        </div>

        <!-- ================= DAMAGE DETAILS ================= -->
        <div class="card mb-4 shadow-sm">
            <div class="card-header bg-light fw-bold">
                3) Damage Details
            </div>
            <div class="card-body">

                <div class="mb-3">
                    <label class="form-label">Damage description</label>
                    <textarea name="DamageDescription"
                              class="form-control"
                              rows="4"
                              required></textarea>
                </div>

                <div class="form-check mb-3">
                    <input class="form-check-input"
                           type="checkbox"
                           id="otherPartyCheck">

                    <label class="form-check-label">
                        Other party involved?
                    </label>
                </div>

                <div id="otherPartySection" class="hidden-section">


                    <div class="mb-3">
                        <label class="form-label">Other party name</label>
                        <input name="OtherPartyName"
                               class="form-control" />
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Other party vehicle plate</label>
                        <input name="OtherPartyPlate"
                               class="form-control" />
                    </div>

                </div>

            </div>
        </div>

        <div class="text-end">
            <button type="submit"
                    class="btn btn-danger btn-lg"
                    formaction="@Url.Action("AccidentReport", "Home")">
                Submit Report
            </button>

            <button type="submit"
                    class="btn btn-outline-dark"
                    formaction="@Url.Action("DownloadAccidentPdf", "Home")">
                Download PDF
            </button>



        </div>

    </form>

</div>


